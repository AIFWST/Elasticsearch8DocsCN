

[Elastic Docs](/guide/) ›[Elasticsearch Guide [8.9]](index.md) ›[Command
line tools](commands.md)

[« Command line tools](commands.md) [elasticsearch-certutil
»](certutil.md)

## elasticsearch-certgen

### 在 6.1 中已弃用。

替换为"elasticsearch-certutil"。

"elasticsearch-certgen"命令简化了证书颁发机构 (CA)、证书签名请求 (CSR) 和签名证书的创建，以便与弹性堆栈一起使用。尽管此命令已弃用，但您无需替换它创建的 CA、CSR 或证书。

###Synopsis

    
    
    bin/elasticsearch-certgen
    (([--cert <cert_file>] [--days <n>] [--dn <name>] [--key <key_file>]
    [--keysize <bits>] [--pass <password>] [--p12 <password>])
    | [--csr])
    [-E <KeyValuePair>] [-h, --help] [--in <input_file>] [--out <output_file>]
    ([-s, --silent] | [-v, --verbose])

###Description

默认情况下，该命令在交互模式下运行，系统会提示您输入有关每个实例的信息。实例是需要传输层安全性 (TLS) 或 SSL 证书的弹性堆栈的任何部分。根据您的配置，Elasticsearch、Logstash、Kibana 和 Beats 可能都需要证书和私钥。

每个实例所需的最小值是一个名称。这可以只是主机名，用作证书的公用名。还可以使用完整的可分辨名称。IP 地址和 DNS 名称是可选的。可以将多个值指定为逗号分隔的字符串。如果未提供 IP 地址或 DNS 名称，则可以在 TLS 或 SSL 配置中禁用主机名验证。

根据您指定的参数，系统还会提示您输入必要的信息，例如输出文件的路径和 CA 私钥密码。

"elasticsearch-certgen"命令还支持静默操作模式，以实现更轻松的批处理操作。有关更多信息，请参阅在静默模式下使用'elasticsearch-certgen'。

输出文件是一个 zip 文件，其中包含每个实例的签名证书和私钥。如果选择生成 CA(这是默认行为)，则证书和私钥将包含在输出文件中。如果选择生成 CSR，则应将其提供给商业或组织特定的证书颁发机构以获取签名证书。签名证书必须采用 PEM 格式才能与弹性堆栈安全功能配合使用。

###Parameters

'--证书 <cert_file>'

     Specifies to generate new instance certificates and keys using an existing CA certificate, which is provided in the `<cert_file>` argument. This parameter cannot be used with the `-csr` parameter. 
`--csr`

     Specifies to operate in certificate signing request mode. 
`--days <n>`

     Specifies an integer value that represents the number of days the generated keys are valid. The default value is `1095`. This parameter cannot be used with the `-csr` parameter. 
`--dn <name>`

     Defines the _Distinguished Name_ that is used for the generated CA certificate. The default value is `CN=Elastic Certificate Tool Autogenerated CA`. This parameter cannot be used with the `-csr` parameter. 
`-E <KeyValuePair>`

     Configures a setting. 
`-h, --help`

     Returns all of the command parameters. 
`--in <input_file>`

     Specifies the file that is used to run in silent mode. The input file must be a YAML file, as described in [Using `elasticsearch-certgen` in Silent Mode](certgen.html#certgen-silent "Using elasticsearch-certgen in Silent Mode"). 
`--key <key_file>`

     Specifies the _private-key_ file for the CA certificate. This parameter is required whenever the `-cert` parameter is used. 
`--keysize <bits>`

     Defines the number of bits that are used in generated RSA keys. The default value is `2048`. 
`--out <output_file>`

     Specifies a path for the output file. 
`--pass <password>`

     Specifies the password for the CA private key. If the `-key` parameter is provided, then this is the password for the existing private key file. Otherwise, it is the password that should be applied to the generated CA key. This parameter cannot be used with the `-csr` parameter. 
`--p12 <password>`

     Generate a PKCS#12 (`.p12` or `.pfx`) container file for each of the instance certificates and keys. The generated file is protected by the supplied password, which can be blank. This parameter cannot be used with the `-csr` parameter. 
`-s, --silent`

     Shows minimal output. 
`-v, --verbose`

     Shows verbose output. 

###Examples

#### 在静默模式下使用 'elasticsearch-certgen'

要使用静默操作模式，您必须创建一个包含有关实例信息的 YAML 文件。它必须与以下格式匹配：

    
    
    instances:
      - name: "node1" __ip: __- "192.0.2.1"
        dns: __- "node1.mydomain.com"
      - name: "node2"
        ip:
          - "192.0.2.2"
          - "198.51.100.1"
      - name: "node3"
      - name: "node4"
        dns:
          - "node4.mydomain.com"
          - "node4.internal"
      - name: "CN=node5,OU=IT,DC=mydomain,DC=com"
        filename: "node5" __

__

|

实例的名称。这可以是简单的字符串值，也可以是可分辨名称 (DN)。这是唯一的必填字段。   ---|---    __

|

表示此实例的 IP 地址的可选字符串数组。允许使用 IPv4 和 IPv6 值。这些值将添加为主题备用名称。   __

|

表示此实例的 DNS 名称的可选字符串数组。这些值将添加为主题备用名称。   __

|

要用于此实例的文件名。此名称用作输出中包含实例文件的目录的名称。它还用于目录中文件的名称中。此文件名不应具有扩展名。注意：如果为实例提供的"名称"不代表有效的文件名，则必须存在"文件名"字段。   当您的 YAML 文件准备就绪时，您可以使用 'elasticsearch-certgen' 命令来生成证书或证书签名请求。只需使用 '-in' 参数指定文件的位置。例如：

    
    
    bin/elasticsearch-certgen -in instances.yml

此命令为 YAMLfile 中列出的实例生成 CA 证书和私钥以及证书和私钥。

[« Command line tools](commands.md) [elasticsearch-certutil
»](certutil.md)
