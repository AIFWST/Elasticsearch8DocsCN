

[Elastic Docs](/guide/) ›[Elasticsearch Guide [8.9]](index.md) ›[Upgrade
Elasticsearch](setup-upgrade.md)

[« Archived settings](archived-settings.md) [Index modules »](index-
modules.md)

## 从较旧的 Elasticsearch 版本中读取索引

Elasticsearch 对在以前的主要版本中创建的索引具有完整的查询和写入支持。如果您在 Elasticsearch 版本5 或 6 中创建了索引，您现在也可以使用存档功能将它们导入到较新的 Elasticsearch 版本中。

归档功能提供了对较旧的 Elasticsearch 数据的较慢的只读访问，出于合规性或法规原因，偶尔回访或调查，或者对部分数据进行冻结。对数据的访问预计不频繁，因此可能会在性能和查询功能有限的情况下发生。

为此，Elasticsearch 能够访问较旧的快照存储库(回到版本 5)。快照存储库中的旧索引可以还原，也可以通过可搜索快照直接访问，这样存档的数据甚至不需要完全驻留在本地磁盘上进行访问。

### 支持的字段类型

旧映射尽可能"按原样"导入到 Elasticsearch 8 中，但仅对选定的字段子集提供常规查询功能：

* 数字类型 * "布尔"类型 * "ip"类型 * "geo_point"类型 * "日期"类型：只要日期字段在这些版本中的行为相似，就支持日期字段上的日期"格式"设置。如果不是，例如在使用自定义日期格式时，可以在旧索引上更新此字段，以便用户可以在需要时进行更改。  *"关键字"类型：只要关键字字段在这些版本中的行为相似，就支持关键字字段上的"规范化器"设置。如果不是，如果需要，可以在旧索引上更新此字段。  * "文本"类型：评分功能有限，所有查询返回等于 1.0 的常量分数。支持文本字段上的"分析器"设置，只要它们在这些版本中的行为相似。如果没有，如果需要，可以在旧索引上更新它们。  * 多字段 * 字段别名 * "对象"字段 * 一些基本的元数据字段，例如用于查询 Elasticsearch 5 索引的"_type" * 运行时字段 * "_source"字段

具有多个映射类型的映射的 Elasticsearch 5 索引在导入之前会尽力折叠在一起。

如果映射的自动导入不起作用，或者新的 Elasticsearchversion 无法理解映射，它会回退到导入没有映射的索引，而是将原始映射存储在导入索引的_meta部分中。然后可以使用 GET 映射 API 对遗留映射进行自省，并且可以使用更新映射 API 手动放置更新的映射，复制和调整旧映射的相关部分以与当前的 Elasticsearch 版本配合使用。虽然自动导入在大多数情况下都可以使用，但这样做的失败应该向 Elastic 团队提出，以便将来进行改进。

### 支持的接口

存档索引是只读的，并通过搜索和字段功能 API 提供数据访问。它们不支持 GetAPI 或任何写入 API。

存档索引允许运行查询以及给定字段类型支持的聚合。

由于"_source"访问，数据也可以重新索引到与当前Elasticsearch版本完全兼容的新索引中。

### 如何升级较旧的 Elasticsearch 5 或 6 集群？

拍摄旧集群中索引的快照，删除 ES 8 不直接支持的索引(即早于 7.0 的索引)，升级集群而不使用旧索引，然后从快照恢复旧索引或通过可搜索快照挂载它们。

在未来，我们计划简化未来的升级过程，以便在使用未来的 majorElasticsearch 版本时更容易使用遗留索引。

[« Archived settings](archived-settings.md) [Index modules »](index-
modules.md)
