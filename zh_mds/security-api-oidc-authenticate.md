

[Elastic Docs](/guide/) ›[Elasticsearch Guide [8.9]](index.md) ›[REST
APIs](rest-apis.md) ›[Security APIs](security-api.md)

[« OpenID Connect prepare authentication API](security-api-oidc-prepare-
authentication.md) [OpenID Connect logout API »](security-api-oidc-
logout.md)

## OpenID Connect authenticateAPI

提交对 oAuth 2.0 身份验证请求的响应，以便从 Elasticsearch 使用。成功验证后，Elasticsearch 将使用 Elasticsearch 内部访问令牌和刷新令牌进行响应，这些令牌随后可用于身份验证。

###Request

'POST /_security/oidc/authenticate'

###Description

这个 API 端点基本上交换了成功的 OpenID Connect 身份验证响应，以获得 Elasticsearch 访问和刷新令牌以用于身份验证。

Elasticsearch 通过 OpenID Connect API 公开所有必要的 OpenID Connect 相关功能。这些 API 由 Kibana 在内部使用，以提供基于 OpenID Connect 的身份验证，但也可以由其他自定义 Web 应用程序或其他客户端使用。另请参阅 OpenID Connect prepareauthentication API 和 OpenID Connect 注销 API

### 请求正文

`redirect_uri`

     (Required, string) The URL to which the OpenID Connect Provider redirected the User Agent in response to an authentication request, after a successful authentication. This URL is expected to be provided as-is (URL encoded), taken from the body of the response or as the value of a `Location` header in the response from the OpenID Connect Provider. 
`state`

     (Required, string) Used to maintain state between the authentication request and the response. This value needs to be the same as the one that was provided to the call to `/_security/oidc/prepare` earlier, or the one that was generated by Elasticsearch and included in the response to that call. 
`nonce`

     (Required, string) Used to associate a Client session with an ID Token and to mitigate replay attacks. This value needs to be the same as the one that was provided to the call to `/_security/oidc/prepare` earlier, or the one that was generated by Elasticsearch and included in the response to that call. 
`realm`

     (Optional, string) Used to identify the name of the OpenID Connect realm that should be used to authenticate this. Useful when multiple realms have been defined. 

###Examples

以下示例请求将身份验证成功后从 OpenID Connect 提供程序返回的响应交换为要在后续请求中使用的 Elasticsearch 访问令牌和刷新令牌。此示例来自使用授权代码授予流的身份验证。

    
    
    POST /_security/oidc/authenticate
    {
      "redirect_uri" : "https://oidc-kibana.elastic.co:5603/api/security/oidc/callback?code=jtI3Ntt8v3_XvcLzCFGq&state=4dbrihtIAt3wBTwo6DxK-vdk-sSyDBV8Yf0AjdkdT5I",
      "state" : "4dbrihtIAt3wBTwo6DxK-vdk-sSyDBV8Yf0AjdkdT5I",
      "nonce" : "WaBPH0KqPVdG5HHdSxPRjfoZbXMCicm5v1OiAj0DUFM",
      "realm" : "oidc1"
    }

以下示例输出包含无响应生成的访问令牌、令牌过期的时间量(以秒为单位)、类型和刷新令牌：

    
    
    {
      "access_token" : "dGhpcyBpcyBub3QgYSByZWFsIHRva2VuIGJ1dCBpdCBpcyBvbmx5IHRlc3QgZGF0YS4gZG8gbm90IHRyeSB0byByZWFkIHRva2VuIQ==",
      "type" : "Bearer",
      "expires_in" : 1200,
      "refresh_token": "vLBPvmAB6KvwvJZr27cS"
    }

[« OpenID Connect prepare authentication API](security-api-oidc-prepare-
authentication.md) [OpenID Connect logout API »](security-api-oidc-
logout.md)
