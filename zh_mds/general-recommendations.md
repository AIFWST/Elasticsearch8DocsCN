

[Elastic Docs](/guide/) ›[Elasticsearch Guide [8.9]](index.md) ›[How
to](how-to.md)

[« How to](how-to.md) [Recipes »](recipes.md)

## 一般建议

### 不返回大型结果集

Elasticsearch被设计为一个搜索引擎，这使得它能够很好地恢复与查询匹配的顶级文档。但是，对于属于数据库域的工作负载(例如检索与特定查询匹配的所有文档)，它就不那么好了。如果需要执行此操作，请确保使用滚动 API。

### 避免大型文档

鉴于默认的"http.max_content_length"设置为100MB，Elasticsearch将拒绝索引任何大于此值的文档。您可能决定增加该特定设置，但 Lucene 仍有大约 2GB 的限制。

即使不考虑硬性限制，大型文档通常也不切实际。大型文档对网络、内存使用和磁盘施加了更大的压力，即使对于不请求"_source"的搜索请求也是如此，因为 Elasticsearch 在所有情况下都需要获取文档的"_id"，并且由于文件系统缓存的工作方式，获取此字段的成本对于大型文档来说更大。为此文档编制索引可以使用的内存量是文档原始大小的乘数。邻近搜索(例如短语查询)和突出显示也变得更加昂贵，因为它们的成本直接取决于原始文档的大小。

有时重新考虑信息单位应该是什么是有用的。例如，您希望使书籍可搜索的事实并不一定意味着文档应该包含整本书。使用章节甚至段落作为文档可能是一个更好的主意，然后在这些文档中有一个属性来标识它们属于哪本书。这不仅避免了大型文档的问题，而且还使搜索体验更好。例如，如果用户搜索两个单词"foo"和"bar"，则不同章节的匹配可能非常差，而同一段落中的匹配可能很好。

[« How to](how-to.md) [Recipes »](recipes.md)
