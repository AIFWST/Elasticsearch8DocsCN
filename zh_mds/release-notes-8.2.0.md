

[Elastic Docs](/guide/) ›[Elasticsearch Guide [8.9]](index.md) ›[Release
notes](es-release-notes.md)

[« Elasticsearch version 8.2.1](release-notes-8.2.1.md) [Elasticsearch
version 8.1.3 »](release-notes-8.1.3.md)

## 弹性搜索版本8.2.0

### 已知问题

* 当数组中的最后一个元素被过滤掉(例如使用"_source_includes")时解析请求失败。这是由于杰克逊解析器中的一个错误。在 Elasticsearch 8.6.1 中修复 (#91456)

### 错误修正

Aggregations

    

* 如果字段是多值的，请不要应用重写为范围优化 #84535 (问题： #82903) * 修复"适应聚合器""toString"方法 #86042 * 修复：嵌套的顶级指标对关键字字段进行排序 #85058 * 修复：从多字段读取数据时使用正确的字段名称 #84752

Analysis

    

* 为"min_hash"配置添加测试并修复设置名称 #84753(问题：#84578)

Authorization

    

* 为 APM 添加"kibana_system"删除权限 #85085 * 确保 API 密钥只能通过"查询ApiKey"API #84859 查看自身 * 修复刷新令牌的所有权 #85010 * 授予"kibana_system"角色对 APM 数据流的读取访问权限 #85744 * 处理内部用户的角色描述符检索 #85049 * 解决超级用户时忽略应用程序权限失败 #85519

EQL

    

* 在出现异常时，通过序列匹配器和断路器清理任何已用内存 #84451

Engine

    

* 在快照索引提交之前增加存储引用 #84776

Geo

    

* 修复了对矢量图块搜索 API 的字段通配符支持 #85595(问题：#85592)

Highlighting

    

* 修复了"match_only_text"#85500 上的通配符突出显示(问题：#85493)

ILM+SLM

    

* 修复堆栈跟踪占用 ILM 错误步骤序列化中的内存 #84266 * 为新创建的索引调用初始"异步操作步骤" #84541(问题：#77269) * 重试清理并创建快照(如果已存在) #83694 #84829(问题：#83694) * 如果收缩索引的分片数量与原始 #84434 相同，则跳过收缩步骤 #84434 (问题： #80180)

索引接口

    

* 在模拟索引模板之前删除现有索引/数据流/别名 #84675(问题：#84256)

Infra/Core

    

* 修复了"系统索引元数据升级服务"隐藏别名处理中的"空指针异常" #84780 (问题： #81411) * 发送响应时防止"线程上下文"标头泄漏 #68649 (问题： #68278) * 将数据路径弃用从严重放宽到警告 #85952 * 需要并保留过滤的休息请求的内容类型 #84914 (问题： #84784) * 返回空版本，如果我们找不到它，则不要炸毁 #85244 * 验证系统索引描述符的索引格式协议 #85173 * 在"doPrivileged"中包装线程创建，请致电 #85180

Infra/Plugins

    

* 加强 elasticsearch 插件版本检查 #85340(问题：#85336)

基础设施/休息接口

    

* 正确返回 V7 兼容模式 #84873 中文档的"_type"字段(问题：#84173)

Ingest

    

* 取消后将"GeoIpDownloaderTask"标记为已完成 #84028 * "复合处理器"在执行处理器时也应捕获异常 #84838(问题：#84781)

License

    

* 修复了 API 密钥和令牌的许可证降级警告 #85276(问题：#75271)

机器学习

    

* 允许从 DFA 作业中的"_source"检索"布尔"字段 #85672 * 避免在重整化程序中出现多个排队的分位数文档 #85555(问题：#85539) * 当节点版本不同时，不允许新的训练模型部署 #85465 * 查找最新状态文档的索引时不要获取源代码 #85334 * 在尝试加载模型之前，请确保推理索引主分片可用 #85569 * 修复文本结构端点中的 Kibana 日期格式和类似覆盖 #84967 * 修复种族停止最近重新定位的数据馈送时的状况 #84636 * 修复文本嵌入更新的序列化 #85863 * 修复了文本结构端点中的多行启动模式 #85066 * 修复了隐藏旧 ML 索引的问题 #85383 * 在节点关闭事件时重新分配模型部署 #85310 * 在跳过的 CCS 群集上重试数据馈送搜索 #84052(问题：#83838) * 使用 GET 异常检测器返回所有数据馈送 #84759

Mapping

    

* 不要在重复的内容字段筛选器上失败 #85382 * 运行时字段核心与映射测试支持 tsdb #83577

Packaging

    

* 删除使用 Cloudflare zlib #84680

Rollup

    

* 向汇总作业配置 #47041 添加对逗号分隔索引模式的支持(问题：#45591)

SQL

    

* 在间隔乘法运算中添加范围检查 #83478 (问题： #83336) * 尽可能避免 GROUP BY 查询的最后一页为空 #84356 (问题： #75528) * 修复 SQLCompatIT.testCursorFromOldNodeFailOnNewNode #85531 (问题： #85520) * 修复了在结果集分页和混合节点环境中 format=txt 的问题 #83833(问题：#83581、#83788) * 改进 ROUND 和 TRUNCATE 以更好地管理多头值和大双打 #85106(问题： #85105， #49391) * 对标量函数中的脚本模板使用精确属性 #84813 (问题： #80551) * 如果""为"空"，则"RANDOM()<expr>"的计算结果始终<expr>为"空" #84632(问题：#84627)

Search

    

* 修复"磁盘使用情况"API 中的点访问者 #84909 * 使用"indices.queries.cache.all_segments"修复跳过缓存因子 #85510 * 在分析磁盘使用情况之前增加存储引用 #84774 * 限制磁盘使用情况 API #84900 中的并发分片请求(问题：#84779) * 重写"must_not"中的"match_all" #85999 * "点扩展XContent解析器"以公开原始令牌位置 #84970 * "传输广播操作"应始终为每个分片设置响应 #84926

Security

    

* "Authentication.token"现在使用现有身份验证的版本 #85978 * 确保令牌在所有情况下都代表有效用户的身份 #84263

Snapshot/Restore

    

* 如果没有 AWS Web 身份令牌的符号链接，则不要失败 #84697 * 公开 GCS 存储库的代理设置 #85785(问题：#84569) * 修复 HDFS 中的原子写入 #85210 * 修复冻结层 #85239 上的泄漏侦听器错误 * 修复节点左侧的快照状态消息 #85021 * 在数据文件夹升级期间忽略冻结的共享缓存文件 #85638(问题：#85603)* s3存储库] 从 STS 终端节点查找适用于 STS 客户端的 AWS 区域 [#84585(问题： #83826)

Stats

    

* 取消统计信息端点 #82685 时丢弃中间结果(问题：#82337)

Transform

    

* 配置保留策略时正确验证权限 #85413(问题：#85409)

Watcher

    

* 避免在数据流指向多个索引时出现观察程序验证错误 #85507(问题：#85508) * 在 WARN 级别记录观察程序群集状态验证错误 #85632 * 不再需要主节点来安装观察程序模板 #85287(问题：#85043)

###Enhancements

Aggregations

    

* Aggs：如果"_doc_count"字段 #84427(问题：#84048)，则没有逐个过滤器 * 从过滤器 #83902 中的查询中提取 agg 边界 * 给 Lucene 更多机会来启用逐个过滤器优化 #85322 * 当日期直方图位于 BoostingQuery 中时，提高"date_histogram"的性能 #83751(问题：#82384、#75542)

Allocation

    

* 使分配说明更具可操作性 #83983 * 使用静态空存储文件元数据 #84034

Audit

    

* 用户配置文件 - 审核配置文件 API 的安全配置更改 #84785

Authentication

    

* 将域信息添加到身份验证对象 #82639 * 改进持久身份验证标头的 BWC #83913(问题：#83567) * 警告具有特殊属性名称的 SAML 属性 #85248(问题：#48613)

Authorization

    

* 添加弹性/企业搜索服务器服务帐户 #83325 * 将日志enterprise_search.api-default的索引权限添加到企业搜索服务器服务帐户 #84965 * 向企业级搜索服务帐户添加索引权限 #85726 * 注意访问被拒绝消息 #85013 中的受限索引 * 更新应用程序配置文件数据的安全全局权限 #83728 * Osquery] 扩展"kibana_system"角色以访问"osquery_manager"索引 [#84279

CRUD

    

* 加快从电汇读取"保留租约" #85159

集群协调

    

* 避免在主服务器上反序列化集群状态 #58416 * 改进对连接失败的日志记录 #84915 * 从主任务执行中删除中间映射 #84406 * 重用"加入任务执行器" #85325 * 加速"元数据状态格式"写入 #85138

数据流

    

* 加速"数据流时间戳字段映射器#postParse" #85270

Discovery-Plugins

    

* 支持 IMDSv2 for EC2 发现 #84410(问题：#80398)

Distributed

    

* 添加弹性搜索健康 API #83119

Geo

    

* 将"geohex_grid"聚合添加到矢量图块 API #84553 * 向矢量图块规范解析添加了缓冲区像素 #84710(问题：#84492) * 仅在必要时规范化多边形 #84229(问题：#35349) * 支持"geo_point"的地理JSON #85120

Health

    

* 修复运行状况指示器中的命名 #83587 * ILM/SLM 运行状况指示器服务 #83440 * 引入运行状况指示器详细信息的专用接口 #83417 * 存储库完整性运行状况指示器服务 #83445 * 分片分配运行状况指示器服务 #83513

ILM+SLM

    

* 在"索引元数据"上缓存 ILM 策略名称 #83603(问题：#83582) * 获取_index_template并获取_component_template请求支持查询参数flat_settings #83297 * 使翻转可取消 #81763 #84584(问题：#81763) * 翻转添加max_primary_shard_docs条件 #80981 * 加快 ILM 群集任务执行速度 #85405(问题：#82708)

索引接口

    

* 批量添加索引块群集状态更新 #84374 * 批量关闭索引群集状态更新 #84259 * 批量打开索引群集状态更新 #83760 * 从"传输滚动更新操作"中删除旧版 CTRAL #84166

Infra/Core

    

* 添加对否定纪元时间戳的支持 #80208(问题：#79135、#72123、#40983) * 允许动态节点设置的 yaml 值 #85186(问题：#65577) * 改进 XContent 数组解析器 #84477 * 优化"不可变OpenMap.Builder" #85184 * 解析系统索引时提供 _system_ 属性 #85042 (问题： #82671) * 删除 Lucene 拆分包 #82132(问题：#81981) * 简化列表读取并将其转换为流 #84183 中的地图 * 加速压缩 XContent 序列化#84802 * 更新"readMap"以避免在阅读过程中调整地图大小 #84045

Infra/Plugins

    

* 签名验证速度慢警告 #84766(问题：#80480)

Infra/Scripting

    

* 脚本：密集矢量的字段 API #83550

Ingest

    

* 解析摄取文档中的路径时不要引发异常 #84659 * 删除处理器更新以支持字段保留 #83665

机器学习

    

* 添加 ML 内存统计信息 API #83802 * 添加对 RoBERTa 和 BART NLP 模型的支持 #84777 * 为训练模型部署添加吞吐量统计信息 #84628 * 提高"zero_shot_classification"标记化性能 #84988(问题：#84820)

Mapping

    

* 检查关键字字段的 utf8 长度在 ES 中不大于 32766，而不是在 Lucene 中。#83738(问题：#80865) * 使"FieldMapper.Param"的构造成本更低 #85191 * 术语枚举支持仅文档值关键字字段 #83482(问题：#83451)

Network

    

* 在 HTTP 路径上使用限制网络写入处理程序 #84751

查询语言

    

* 添加"unsigned_long"类型支持 #65145(问题：#63312)

Recovery

    

* 改进了从快照恢复中的故障日志记录 #84910

Reindex

    

* 使用"安全字符串"从远程密码 #85091 重新索引

SQL

    

* 为 SQL CLI 添加宽松选项 #83795 (问题： #67436) * 对 JDBC 驱动程序 #84499 的前向警告标头 * 将数据流列为视图 #85168(问题：#83449) * "分组依据"和"透视"查询的 PIT #84605(问题：#84349) * 将滚动光标替换为时间点和"search_after" #83381(问题：#61873、#80523)

Search

    

* 将过滤添加到字段上限端点 #83636(问题：#82966) * 通过索引映射哈希 #83494 对字段上限响应进行分组(问题：#78665、#82879) * 集成对 ANN #84734 的过滤支持(问题：#81788) * 加快合并字段上限响应 #83704

Security

    

* 在需要时绑定所有主机，而不仅仅是 _site_ #83145 * 队列：为 .fleet-actions-results"action_input_type"字段添加新映射 #84316 * 更新 X509证书主体方法 #85163(问题：#81008) * 用户配置文件 - 添加用于启用/禁用配置文件的 API #84548 * 用户配置文件 - 添加 REST 规范文件和测试 #83307 * 用户配置文件 - 更多 REST 规范、测试、API 文档 #84597 * 用户配置文件 - 更新 API 以使用域 #83570 * 用户配置文件 - 更新 的 xpack 用法输出域 #84747 * 用户配置文件 - 在创建 API 密钥和令牌时捕获域 #84547 * 用户配置文件：添加功能标志 #83347 * 用户配置文件：添加初始搜索配置文件 API #83191 * 用户配置文件：处理创建新配置文件的赛车 #84208

TSDB

    

* TSDB：在版本冲突时展开"_id" #84957 * TSDB：拒绝配置time_series_dimension #83920 的嵌套对象字段 * TSDB：路由路径对象类型检查改进 #83310 * TSDB：收缩"_id"倒排索引 #85008

Watcher

    

* 为 Watcher 电子邮件操作 #84894 添加允许的域列表(问题：#84739)

### 新功能

Aggregations

    

* 新的"random_sampler"聚合，用于聚合中的采样文档 #84363

Authentication

    

* 添加 JWT 领域对 JWT 验证的支持 #83155 * 为 JWT 领域布线添加冒烟测试 #84249 * 支持 JWT 领域中的邮件、名称和 dn 声明 #84907

Authorization

    

* 具有安全域的 API 密钥 API #84704

Health

    

* 添加健康指示器插件 #83205 * 将影响块添加到健康信息 API 响应 #84899(问题：#84773)

索引接口

    

* 为组件模板添加 cat api#71274(问题：#68941)

Infra/Core

    

* 引入未经身份验证的终结点进行准备情况检查 #84375(问题：#81168)

机器学习

    

* 添加新的"change_point"管道聚合 #83428

Search

    

* 引入查找运行时字段 #82385 * 解决磁盘使用 API 中的通配符 #84832

TSDB

    

* TSDB：支持 GET 和 DELETE 以及文档版本控制 #82633

###Upgrades

Infra/Core

    

* 将 x-内容的杰克逊升级到 2.13.2 #84905

Ingest

    

* 凹凸共享压缩到 1.21 #85581

Network

    

* 将Netty升级到4.1.74 #84562

Packaging

    

* 升级到 JDK 18.0.0+36 #85376(问题：#85357)

Search

    

* 升级到 lucene 9.1.0-snapshot-5b522487ba8 #85025

[« Elasticsearch version 8.2.1](release-notes-8.2.1.md) [Elasticsearch
version 8.1.3 »](release-notes-8.1.3.md)
