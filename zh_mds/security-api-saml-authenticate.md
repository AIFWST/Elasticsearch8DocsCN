

[Elastic Docs](/guide/) ›[Elasticsearch Guide [8.9]](index.md) ›[REST
APIs](rest-apis.md) ›[Security APIs](security-api.md)

[« SAML prepare authentication API](security-api-saml-prepare-
authentication.md) [SAML logout API »](security-api-saml-logout.md)

## SAML 身份验证接口

向 Elasticsearch 提交 SAML"响应"消息以供使用。

此 API 旨在供 Kibana 以外的自定义 Web 应用程序使用。如果您使用的是 Kibana，请参阅在 ElasticStack 上配置 SAML 单点登录。

###Request

'POST /_security/saml/authenticate'

###Description

提交的 SAML 消息可以是：

* 对之前使用 SAML 准备身份验证 API 创建的 SAML 身份验证请求的响应。  * 在 IdP 发起的单点登录 (SSO) 流的情况下，未经请求的 SAML 消息。

在任一情况下，SAML 消息都需要是根元素为 '' 的 base64 编码的 XML 文档<Response>

验证成功后，Elasticsearch 会使用 Elasticsearch内部访问令牌和刷新令牌进行响应，这些令牌随后可用于身份验证。此 API 端点实质上交换 SAML 响应，这些响应指示 IdP 中身份验证成功，以便获得 Elasticsearch 访问和刷新令牌，这些令牌可用于针对 Elasticsearch 进行身份验证。

Elasticsearch通过SAML API公开所有必要的SAML相关功能。这些 API 由 Kibana 在内部使用，以提供基于 SAML 的身份验证，但也可以由其他自定义 Web 应用程序或其他客户端使用。另请参阅 SAML 准备身份验证 API、SAMLinvalidate API、SAML 注销 API 和 SAMLcomplete 注销 API。

### 请求正文

`content`

     (Required, string) The SAML response as it was sent by the user's browser, usually a Base64 encoded XML document. 
`ids`

     (Required, array) A json array with all the valid SAML Request Ids that the caller of the API has for the current user. 
`realm`

     (Optional, string) The name of the realm that should authenticate the SAML response. Useful in cases where many SAML realms are defined. 

### 响应正文

`access_token`

     (string) The access token that was generated by Elasticsearch. 
`username`

     (string) The authenticated user's name. 
`expires_in`

     (integer) The amount of time (in seconds) left until the token expires. 
`refresh_token`

     (string) The refresh token that was generated by Elasticsearch. 
`realm`

     (string) The name of the realm that the user was authenticated by. 

###Examples

以下示例将指示 SAML IdP 身份验证成功的 SAML 响应交换为 Elasticsearch 访问令牌和刷新令牌，以便在后续请求中使用：

    
    
    POST /_security/saml/authenticate
    {
      "content" : "PHNhbWxwOlJlc3BvbnNlIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIHhtbG5zOnNhbWw9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMD.....",
      "ids" : ["4fee3b046395c4e751011e97f8900b5273d56685"]
    }

API 返回以下响应：

    
    
    {
      "access_token" : "46ToAxZVaXVVZTVKOVF5YU04ZFJVUDVSZlV3",
      "username" : "Bearer",
      "expires_in" : 1200,
      "refresh_token": "mJdXLtmvTUSpoLwMvdBt_w",
      "realm": "saml1"
    }

[« SAML prepare authentication API](security-api-saml-prepare-
authentication.md) [SAML logout API »](security-api-saml-logout.md)
